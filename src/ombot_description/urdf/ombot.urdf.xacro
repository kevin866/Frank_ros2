<?xml version="1.0"?>
<robot name="ombot" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- Base geometry (MACRO LIB) -->
  <xacro:include filename="/home/frank/frank_ws/src/ombot_description/urdf/base/mecanum_base.urdf.xacro"/>
  <!-- Instantiate base -->
  <xacro:mecanum_base
    prefix=""
    sep_x="0.40"
    sep_y="0.30"
    wheel_radius="0.05"/>

  <!-- Arm geometry (MACRO LIB) -->
  <xacro:include filename="/home/frank/frank_ws/src/ombot_description/urdf/arm/ombot_arm_module.urdf.xacro"/>
  <!-- Mount arm; set pose/prefix as needed -->
  <xacro:ombot_arm_module
    parent="base_link"
    mount_xyz="0 0 0.01"
    mount_rpy="0 0 0"
    prefix=""/>

  <!-- ONE combined ros2_control block for base + arm hardware -->
  <!-- If your macros already “emit” <ros2_control>, remove those and keep this single block. -->
  <ros2_control name="ombot_hw" type="system">
    <!-- BASE HARDWARE -->
    <hardware>
      <plugin>ombot_hardware/OMBotBaseSystem</plugin>
        <param name="controller_1_port">/dev/ttyACM0</param>
        <param name="controller_2_port">/dev/ttyACM1</param>
        <param name="controller_baud">115200</param>

        <!-- joint→channel mapping -->
        <param name="fl_map">ctrl1:A</param>
        <param name="fr_map">ctrl1:B</param>
        <param name="rl_map">ctrl2:A</param>
        <param name="rr_map">ctrl2:B</param>

        <!-- kinematics & limits -->
        <param name="wheel_radius">0.0762</param>
        <param name="encoder_cpr">2048</param>
        <param name="gear_ratio">1.0</param>
        <param name="max_wheel_rad_s">20.0</param>
    </hardware>

    <!-- ARM HARDWARE -->
    <!-- <hardware>
      <plugin>ombot_hardware/OMBotArmSystem</plugin>
      <param name="port">/dev/ttyUSB0</param>
      <param name="baudrate">1000000</param>
      <param name="default_mode">effort</param>
      <param name="simulate">false</param>
    </hardware> -->

    <!-- Exported joints/interfaces.
         Keep these in sync with your geometry macros’ joint names. -->

    <joint name="front_left_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="front_right_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="rear_left_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="rear_right_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>

    <!-- Arm joints (prefix “arm_” because of the module call above) -->
    <!-- <joint name="arm_joint_1">
      <command_interface name="position"/>
      <command_interface name="effort"/>
      <state_interface   name="position"/>
      <state_interface   name="velocity"/>
      <state_interface   name="effort"/>
    </joint>
    <joint name="arm_joint_2">
      <command_interface name="position"/>
      <command_interface name="effort"/>

      <state_interface   name="position"/>
      <state_interface   name="velocity"/>
      <state_interface   name="effort"/>
    </joint>
    <joint name="arm_joint_3">
      <command_interface name="position"/>
      <command_interface name="effort"/>

      <state_interface   name="position"/>
      <state_interface   name="velocity"/>
      <state_interface   name="effort"/>
    </joint>
    <joint name="arm_joint_4">
      <command_interface name="position"/>
      <command_interface name="effort"/>

      <state_interface   name="position"/>
      <state_interface   name="velocity"/>
      <state_interface   name="effort"/>
    </joint>
    <joint name="arm_joint_5">
      <command_interface name="position"/>
      <command_interface name="effort"/>

      <state_interface   name="position"/>
      <state_interface   name="velocity"/>
      <state_interface   name="effort"/>
    </joint>
    <joint name="arm_joint_6">
      <command_interface name="position"/>
      <command_interface name="effort"/>

      <state_interface   name="position"/>
      <state_interface   name="velocity"/>
      <state_interface   name="effort"/>
    </joint> -->
  </ros2_control>

</robot>
